{% extends "base.html" %}
{% block content %}
<div class="container mt-4" style="max-width: 600px;">
  <div class="card">
    <div class="card-body">
      <h2 class="card-title mb-4">Request a Date Change (Confirmed Booking)</h2>
      <form method="post" class="needs-validation" novalidate>
        {% csrf_token %}
        <div class="mb-3">
          <label for="start_date" class="form-label">New Start Date:</label>
          <input type="date" name="start_date" id="start_date" class="form-control" required>
        </div>
        <div class="mb-3">
          <label for="end_date" class="form-label">New End Date:</label>
          <input type="date" name="end_date" id="end_date" class="form-control" required>
        </div>
        <button type="submit" class="btn btn-primary">
          <i class="fas fa-paper-plane"></i> Submit Request
        </button>
      </form>
    </div>
  </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    // Initialize Flatpickr for the date inputs with minDate set to today
    flatpickr("#start_date", {
        minDate: "today",
        altInput: true,
        altFormat: "F j, Y",
        dateFormat: "Y-m-d"
    });
    flatpickr("#end_date", {
        minDate: "today",
        altInput: true,
        altFormat: "F j, Y",
        dateFormat: "Y-m-d"
    });

    // Bootstrap form validation
    (function () {
      'use strict'
      var forms = document.querySelectorAll('.needs-validation')
      Array.prototype.slice.call(forms)
        .forEach(function (form) {
          form.addEventListener('submit', function (event) {
            if (!form.checkValidity()) {
              event.preventDefault();
              event.stopPropagation();
            }
            form.classList.add('was-validated');
          }, false);
        });
    })();
});
</script>
{% endblock %}